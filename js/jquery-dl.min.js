!function(e){e.fn.downloader=function(t){if(this.length){e.fn.downloader.makeFileInput=function(){var t=e.fn.downloader.getFileIndex(),n=document.createElement("input");return n.setAttribute("type","file"),n.setAttribute("id",t),n.setAttribute("name",t+"[]"),n.setAttribute("multiple","multiple"),n.classList.add("fileInput"),n.style.cssText="display:block;position:absolute;top:0;left:-9999px;",e.fn.downloader.fileIndex_increment(),n},e.fn.downloader.updateFileList=function(){var t=document.getElementById("table_fileList");if(n.desc)for(var i=[],l=0;l<t.children[1].children.length;l++)i.push({name:t.children[1].children[l].children[0].children[0].innerHTML,desc:t.children[1].children[l].children[1].children[0].value});t.children[1].innerHTML="";for(var d=document.getElementsByClassName("fileInput"),a=0,l=0;l<d.length-1;l++)for(var r=0;r<d[l].files.length;r++){var o=document.createElement("span");o.className="redhover",o.innerHTML=d[l].files[r].name,o.setAttribute("data-inputid","file"+l),e(o).on("click",function(){e.fn.downloader.removeFile(this)});var s=document.createElement("td");s.appendChild(o),s.setAttribute("title","Size: "+e.fn.downloader.bytesToSize(d[l].files[r].size)+"\nType: "+d[l].files[r].type+"\n\nClick to Remove"),s.setAttribute("data-toggle","tooltip"),s.setAttribute("data-container","body");var c=document.createElement("tr");if(c.appendChild(s),n.desc){for(var f="",u=0;u<i.length;u++)if(d[l].files[r].name==i[u].name){f=i[u].desc;break}var m=document.createElement("td");m.innerHTML='<input type="text" name="file_'+a+'_desc" class="'+n.classes.input+'" value="'+f+'" maxlength="1024" />',c.appendChild(m)}t.children[1].appendChild(c),a++}0===t.children[1].children.length?e("#table_fileList th").css("visibility","hidden"):e("#table_fileList th").css("visibility",""),tooltip()},e.fn.downloader.getNewFileInput=function(){return e(".fileInput").last()[0]},e.fn.downloader.getFileIndex=function(){return"file"+document.getElementById("hidden_fileIndex").value},e.fn.downloader.fileIndex_increment=function(){var e=document.getElementById("hidden_fileIndex");e.value=parseInt(e.value)+1},e.fn.downloader.rebind=function(){e(".fileInput").unbind().on("change",function(){e.fn.downloader.filesAdded()})},e.fn.downloader.addFile=function(){e(e.fn.downloader.getNewFileInput()).click()},e.fn.downloader.removeFile=function(t){function n(){for(var e=document.getElementsByClassName("fileInput"),t=0;t<e.length;t++)e[t].setAttribute("id","file"+t),e[t].setAttribute("name","file"+t);document.getElementById("hidden_fileIndex").value=t}var i=e(t).data("inputid");e("#"+i).remove(),n();document.getElementById("hidden_fileIndex");e.fn.downloader.updateFileList(),e.fn.downloader.rebind(),tooltip();var l=e.fn.downloader.validateTotalFileSize(),d=e.fn.downloader.validateTotalFileLimit();l&&d&&(document.getElementById("span_fileerror").innerHTML=""),"function"==typeof enableDisable_addHike&&enableDisable_addHike()},e.fn.downloader.removeAll=function(){e('input[id^="file"]').remove(),document.getElementById("hidden_fileIndex").value=0,document.getElementById("div_inputFileWrapper").appendChild(e.fn.downloader.makeFileInput()),e.fn.downloader.updateFileList(),e.fn.downloader.rebind(),tooltip();var t=e.fn.downloader.validateTotalFileSize(),n=e.fn.downloader.validateTotalFileLimit();t&&n&&(document.getElementById("span_fileerror").innerHTML=""),"function"==typeof enableDisable_addHike&&enableDisable_addHike()},e.fn.downloader.filesAdded=function(){e.fn.downloader.preExists()?(e.fn.downloader.removeLastAdd(),e.fn.downloader.showError()):(document.getElementById("div_inputFileWrapper").appendChild(e.fn.downloader.makeFileInput()),e.fn.downloader.updateFileList(),e.fn.downloader.rebind());var t=e.fn.downloader.validateTotalFileSize(),n=e.fn.downloader.validateTotalFileLimit();t&&n&&(document.getElementById("span_fileerror").innerHTML=""),"function"==typeof enableDisable_addHike&&enableDisable_addHike()},e.fn.downloader.preExists=function(){function e(){for(var e=t[t.length-1].files,n=[],i=0;i<e.length;i++)n[i]=e[i].name;return n}for(var t=document.getElementsByClassName("fileInput"),n=e(),i=0;i<t.length-1;i++)for(var l=0;l<t[i].files.length;l++){var d=t[i].files[l].name;if(-1!==n.indexOf(d))return!0}return!1},e.fn.downloader.validateTotalFileSize=function(){var t=0;return e(".fileInput").each(function(){for(var e=0;e<this.files.length;e++)t+=this.files[e].size}),t>=98e6?(e(".jqdl-attachments").each(function(){this.classList.add("has-error"),this.classList.add("has_error");var t=document.createElement("a");t.innerHTML="&#8226;";var n=t.innerHTML,i=document.getElementById("span_fileerror");""==i.innerHTML?i.innerHTML='<ul class="list-unstyled"><li>'+n+"Max file size exceeded</li></ul>":i.children[0].innerHTML+="<li>"+n+"Max file size exceeded</li>",e("#downloader button, #downloader .redhover").one("click",function(){i.innerHTML="",e(".jqdl-attachments").each(function(){this.classList.remove("has-error")})}),e("form, .fileInput").off("change")}),!1):!0},e.fn.downloader.validateTotalFileLimit=function(){var t=0;return e(".fileInput").each(function(){t+=this.files.length}),t>10?(e(".jqdl-attachments").each(function(){this.classList.add("has-error"),this.classList.add("has_error");var t=document.createElement("a");t.innerHTML="&#8226;";var n=t.innerHTML,i=document.getElementById("span_fileerror");""==i.innerHTML?i.innerHTML='<ul class="list-unstyled"><li>'+n+"Max file limit exceeded</li></ul>":i.children[0].innerHTML+="<li>"+n+"Max file limit exceeded</li>",e("#downloader button, #downloader .redhover").one("click",function(){i.innerHTML="",e(".jqdl-attachments").each(function(){this.classList.remove("has-error")})}),e("form, .fileInput").off("change")}),!1):!0},e.fn.downloader.removeLastAdd=function(){var e=document.getElementsByClassName("fileInput");e[e.length-1].value=""},e.fn.downloader.showError=function(){alert("File already added")};{var n=e.extend({text:"Add File",clearText:"Remove All",classes:{button:"btn btn-sm btn-default",input:"form-control form-control-sm",a:"",container:"container-fluid"},desc:!1},t),i=this[0];i.id}i.className=i.className+" "+n.classes.container;var l=document.createElement("div");l.className="btn-group",l.style.display="inline-block",l.style.width="100%";var d=document.createElement("div");d.className="scroll scroll300",d.style["margin-top"]="4px";var a=document.createElement("div");a.setAttribute("id","div_inputFileWrapper"),a.style.cssText="position:relative;overflow:hidden;width:0;";var r=document.createElement("table");r.setAttribute("id","table_fileList"),r.style["font-size"]="0.8em",r.style.width="100%",r.innerHTML='<thead><tr><th style="width:50%;visibility:hidden;">File</th><th style="width:50%;visibility:hidden;">Description/Credited to</th></tr></thead><tbody></tbody>';var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("id","hidden_fileIndex"),o.setAttribute("name","hidden_fileIndex"),o.value="0";var s=document.createElement("button");s.setAttribute("type","button"),s.innerHTML=n.text,s.className=n.classes.button,e(s).on("click",function(){e.fn.downloader.addFile()});var c=document.createElement("button");c.setAttribute("type","button"),c.innerHTML=n.clearText,c.className=n.classes.button,e(c).on("click",function(){e.fn.downloader.removeAll()});var f=document.createElement("span");return f.setAttribute("id","span_fileerror"),f.className="help-block with-errors",i.appendChild(o),i.appendChild(l),i.appendChild(d),i.appendChild(f),i.appendChild(a),l.appendChild(s),l.appendChild(c),d.appendChild(r),a.appendChild(e.fn.downloader.makeFileInput()),e.fn.downloader.rebind(),this}}}($),$.fn.downloader.bytesToSize=function(e){var t=["bytes","KB","MB","GB","TB"];if(0==e)return"0 bytes";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,n),2)+t[n]};