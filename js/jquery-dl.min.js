!function(e){e.fn.downloader=function(n){if(this.length){e.fn.downloader.makeFileInput=function(){var n=e.fn.downloader.getFileIndex(),t=document.createElement("input");return t.setAttribute("type","file"),t.setAttribute("id",n),t.setAttribute("name",n+"[]"),t.setAttribute("multiple","multiple"),t.classList.add("fileInput"),t.style.display="none",e.fn.downloader.fileIndex_increment(),t},e.fn.downloader.updateFileList=function(){var n=document.getElementById("table_fileList");if(t.desc)for(var i=[],l=0;l<n.children[1].children.length;l++)i.push({name:n.children[1].children[l].children[0].children[0].innerHTML,desc:n.children[1].children[l].children[1].children[0].value});n.children[1].innerHTML="";for(var d=document.getElementsByClassName("fileInput"),a=0,l=0;l<d.length-1;l++)for(var r=0;r<d[l].files.length;r++){var o=document.createElement("span");o.className="redhover",o.innerHTML=d[l].files[r].name,o.setAttribute("data-inputid","file"+l),e(o).on("click",function(){e.fn.downloader.removeFile(this)});var s=document.createElement("td");s.appendChild(o),s.setAttribute("title","Size: "+e.fn.downloader.bytesToSize(d[l].files[r].size)+"\nType: "+d[l].files[r].type+"\n\nClick to Remove"),s.setAttribute("data-toggle","tooltip"),s.setAttribute("data-container","body");var c=document.createElement("tr");if(c.appendChild(s),t.desc){for(var f="",u=0;u<i.length;u++)if(d[l].files[r].name==i[u].name){f=i[u].desc;break}var m=document.createElement("td");m.innerHTML='<input type="text" name="file_'+a+'_desc" class="'+t.classes.input+'" value="'+f+'" maxlength="1024" />',c.appendChild(m)}n.children[1].appendChild(c),a++}0===n.children[1].children.length?e("#table_fileList th").css("visibility","hidden"):e("#table_fileList th").css("visibility",""),tooltip()},e.fn.downloader.getNewFileInput=function(){return e(".fileInput").last()[0]},e.fn.downloader.getFileIndex=function(){return"file"+document.getElementById("hidden_fileIndex").value},e.fn.downloader.fileIndex_increment=function(){var e=document.getElementById("hidden_fileIndex");e.value=parseInt(e.value)+1},e.fn.downloader.rebind=function(){e(".fileInput").unbind().on("change",function(){e.fn.downloader.filesAdded()})},e.fn.downloader.addFile=function(){e(e.fn.downloader.getNewFileInput()).click()},e.fn.downloader.removeFile=function(n){function t(){for(var e=document.getElementsByClassName("fileInput"),n=0;n<e.length;n++)e[n].setAttribute("id","file"+n),e[n].setAttribute("name","file"+n);document.getElementById("hidden_fileIndex").value=n}var i=e(n).data("inputid");e("#"+i).remove(),t();document.getElementById("hidden_fileIndex");e.fn.downloader.updateFileList(),e.fn.downloader.rebind(),tooltip();var l=e.fn.downloader.validateTotalFileSize(),d=e.fn.downloader.validateTotalFileLimit();l&&d&&(document.getElementById("span_fileerror").innerHTML=""),"function"==typeof enableDisable_addHike&&enableDisable_addHike()},e.fn.downloader.removeAll=function(){e('input[id^="file"]').remove(),document.getElementById("hidden_fileIndex").value=0,document.getElementById("div_inputFileWrapper").appendChild(e.fn.downloader.makeFileInput()),e.fn.downloader.updateFileList(),e.fn.downloader.rebind(),tooltip();var n=e.fn.downloader.validateTotalFileSize(),t=e.fn.downloader.validateTotalFileLimit();n&&t&&(document.getElementById("span_fileerror").innerHTML=""),"function"==typeof enableDisable_addHike&&enableDisable_addHike()},e.fn.downloader.filesAdded=function(){e.fn.downloader.preExists()?(e.fn.downloader.removeLastAdd(),e.fn.downloader.showError()):(document.getElementById("div_inputFileWrapper").appendChild(e.fn.downloader.makeFileInput()),e.fn.downloader.updateFileList(),e.fn.downloader.rebind());var n=e.fn.downloader.validateTotalFileSize(),t=e.fn.downloader.validateTotalFileLimit();n&&t&&(document.getElementById("span_fileerror").innerHTML=""),"function"==typeof enableDisable_addHike&&enableDisable_addHike()},e.fn.downloader.preExists=function(){function e(){for(var e=n[n.length-1].files,t=[],i=0;i<e.length;i++)t[i]=e[i].name;return t}for(var n=document.getElementsByClassName("fileInput"),t=e(),i=0;i<n.length-1;i++)for(var l=0;l<n[i].files.length;l++){var d=n[i].files[l].name;if(-1!==t.indexOf(d))return!0}return!1},e.fn.downloader.validateTotalFileSize=function(){var n=0;return e(".fileInput").each(function(){for(var e=0;e<this.files.length;e++)n+=this.files[e].size}),n>=98e6?(e(".jqdl-attachments").each(function(){this.classList.add("has-error"),this.classList.add("has_error");var n=document.createElement("a");n.innerHTML="&#8226;";var t=n.innerHTML,i=document.getElementById("span_fileerror");""==i.innerHTML?i.innerHTML='<ul class="list-unstyled"><li>'+t+"Max file size exceeded</li></ul>":i.children[0].innerHTML+="<li>"+t+"Max file size exceeded</li>",e("#downloader button, #downloader .redhover").one("click",function(){i.innerHTML="",e(".jqdl-attachments").each(function(){this.classList.remove("has-error")})}),e("form, .fileInput").off("change")}),!1):!0},e.fn.downloader.validateTotalFileLimit=function(){var n=0;return e(".fileInput").each(function(){n+=this.files.length}),n>10?(e(".jqdl-attachments").each(function(){this.classList.add("has-error"),this.classList.add("has_error");var n=document.createElement("a");n.innerHTML="&#8226;";var t=n.innerHTML,i=document.getElementById("span_fileerror");""==i.innerHTML?i.innerHTML='<ul class="list-unstyled"><li>'+t+"Max file limit exceeded</li></ul>":i.children[0].innerHTML+="<li>"+t+"Max file limit exceeded</li>",e("#downloader button, #downloader .redhover").one("click",function(){i.innerHTML="",e(".jqdl-attachments").each(function(){this.classList.remove("has-error")})}),e("form, .fileInput").off("change")}),!1):!0},e.fn.downloader.removeLastAdd=function(){var e=document.getElementsByClassName("fileInput");e[e.length-1].value=""},e.fn.downloader.showError=function(){alert("File already added")};{var t=e.extend({text:"Add File",clearText:"Remove All",classes:{button:"btn btn-sm btn-default",input:"form-control form-control-sm",a:"",container:"container-fluid"},desc:!1},n),i=this[0];i.id}i.className=i.className+" "+t.classes.container;var l=document.createElement("div");l.className="btn-group",l.style.display="inline-block",l.style.width="100%";var d=document.createElement("div");d.className="scroll scroll300",d.style["margin-top"]="4px";var a=document.createElement("div");a.setAttribute("id","div_inputFileWrapper"),a.style.display="none";var r=document.createElement("table");r.setAttribute("id","table_fileList"),r.style["font-size"]="0.8em",r.style.width="100%",r.innerHTML='<thead><tr><th style="width:50%;visibility:hidden;">File</th><th style="width:50%;visibility:hidden;">Description/Credited to</th></tr></thead><tbody></tbody>';var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("id","hidden_fileIndex"),o.setAttribute("name","hidden_fileIndex"),o.value="0";var s=document.createElement("button");s.setAttribute("type","button"),s.innerHTML=t.text,s.className=t.classes.button,e(s).on("click",function(){e.fn.downloader.addFile()});var c=document.createElement("button");c.setAttribute("type","button"),c.innerHTML=t.clearText,c.className=t.classes.button,e(c).on("click",function(){e.fn.downloader.removeAll()});var f=document.createElement("span");return f.setAttribute("id","span_fileerror"),f.className="help-block with-errors",i.appendChild(o),i.appendChild(l),i.appendChild(d),i.appendChild(f),i.appendChild(a),l.appendChild(s),l.appendChild(c),d.appendChild(r),a.appendChild(e.fn.downloader.makeFileInput()),e.fn.downloader.rebind(),this}}}($),$.fn.downloader.bytesToSize=function(e){var n=["bytes","KB","MB","GB","TB"];if(0==e)return"0 bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+n[t]};